<!DOCTYPE html>
<html>
<head>
<title>BFCache JavaScript Eviction Test (Delayed)</title>
</head>
<body>
  <h1>BFCache JavaScript Eviction Test</h1>
  <button id="triggerEviction">Trigger Eviction (5 Second Delay)</button>
  <p id="result">Click the button to trigger JavaScript eviction.</p>

  <script>
    document.getElementById("triggerEviction").addEventListener("click", async function() {
      // Delay for 5 seconds
      await new Promise(resolve => setTimeout(resolve, 5000));

      // Trigger JavaScript eviction by requesting camera access
      try {
        const stream = await navigator.mediaDevices.getUserMedia({ video: true });
      } catch (error) {
        console.error("Error accessing camera:", error);
      }

      // Check for BFCache eviction reason
      if (window.performance.navigation.notRestoredReasons) {
        const reasons = window.performance.navigation.notRestoredReasons.reasons;
        console.log(reasons);
        if (reasons.includes('JavaScriptEviction')) {
          document.getElementById("result").textContent = "Page was evicted from BFCache due to JavaScript eviction!";
        } else {
          document.getElementById("result").textContent = "JavaScript eviction triggered, but not sure if BFCache eviction occurred.";
        }
      } else {
        document.getElementById("result").textContent = "JavaScript eviction triggered, but browser doesn't support NotRestoredReasons API.";
      }
    });
  </script>
</body>
</html>